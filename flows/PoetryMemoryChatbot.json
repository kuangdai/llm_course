{"id":"6d9cea33-f78c-464e-a98e-bbe8bb60792a","data":{"nodes":[{"data":{"description":"Get chat inputs from the Playground.","display_name":"Chat Input","id":"ChatInput-gqewG","node":{"template":{"_type":"Component","files":{"trace_as_metadata":true,"file_path":"","fileTypes":["txt","md","mdx","csv","json","yaml","yml","xml","html","htm","pdf","docx","py","sh","sql","js","ts","tsx","jpg","jpeg","png","bmp","image"],"list":true,"required":false,"placeholder":"","show":true,"name":"files","value":"","display_name":"Files","advanced":true,"dynamic":false,"info":"Files to be sent with the message.","title_case":false,"type":"file","_input_type":"FileInput"},"background_color":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"background_color","value":"","display_name":"Background Color","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The background color of the icon.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"chat_icon":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"chat_icon","value":"","display_name":"Icon","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The icon of the message.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.base.data.utils import IMG_FILE_TYPES, TEXT_FILE_TYPES\nfrom langflow.base.io.chat import ChatComponent\nfrom langflow.inputs import BoolInput\nfrom langflow.io import DropdownInput, FileInput, MessageTextInput, MultilineInput, Output\nfrom langflow.schema.message import Message\nfrom langflow.utils.constants import MESSAGE_SENDER_AI, MESSAGE_SENDER_NAME_USER, MESSAGE_SENDER_USER\n\n\nclass ChatInput(ChatComponent):\n    display_name = \"Chat Input\"\n    description = \"Get chat inputs from the Playground.\"\n    icon = \"MessagesSquare\"\n    name = \"ChatInput\"\n\n    inputs = [\n        MultilineInput(\n            name=\"input_value\",\n            display_name=\"Text\",\n            value=\"\",\n            info=\"Message to be passed as input.\",\n        ),\n        BoolInput(\n            name=\"should_store_message\",\n            display_name=\"Store Messages\",\n            info=\"Store the message in the history.\",\n            value=True,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"sender\",\n            display_name=\"Sender Type\",\n            options=[MESSAGE_SENDER_AI, MESSAGE_SENDER_USER],\n            value=MESSAGE_SENDER_USER,\n            info=\"Type of sender.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"sender_name\",\n            display_name=\"Sender Name\",\n            info=\"Name of the sender.\",\n            value=MESSAGE_SENDER_NAME_USER,\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"session_id\",\n            display_name=\"Session ID\",\n            info=\"The session ID of the chat. If empty, the current session ID parameter will be used.\",\n            advanced=True,\n        ),\n        FileInput(\n            name=\"files\",\n            display_name=\"Files\",\n            file_types=TEXT_FILE_TYPES + IMG_FILE_TYPES,\n            info=\"Files to be sent with the message.\",\n            advanced=True,\n            is_list=True,\n        ),\n        MessageTextInput(\n            name=\"background_color\",\n            display_name=\"Background Color\",\n            info=\"The background color of the icon.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"chat_icon\",\n            display_name=\"Icon\",\n            info=\"The icon of the message.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"text_color\",\n            display_name=\"Text Color\",\n            info=\"The text color of the name\",\n            advanced=True,\n        ),\n    ]\n    outputs = [\n        Output(display_name=\"Message\", name=\"message\", method=\"message_response\"),\n    ]\n\n    def message_response(self) -> Message:\n        _background_color = self.background_color\n        _text_color = self.text_color\n        _icon = self.chat_icon\n        message = Message(\n            text=self.input_value,\n            sender=self.sender,\n            sender_name=self.sender_name,\n            session_id=self.session_id,\n            files=self.files,\n            properties={\"background_color\": _background_color, \"text_color\": _text_color, \"icon\": _icon},\n        )\n        if self.session_id and isinstance(message, Message) and self.should_store_message:\n            stored_message = self.send_message(\n                message,\n            )\n            self.message.value = stored_message\n            message = stored_message\n\n        self.status = message\n        return message\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"input_value":{"tool_mode":false,"trace_as_input":true,"multiline":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"input_value","value":"Hello","display_name":"Text","advanced":false,"input_types":["Message"],"dynamic":false,"info":"Message to be passed as input.","title_case":false,"type":"str","_input_type":"MultilineInput"},"sender":{"tool_mode":false,"trace_as_metadata":true,"options":["Machine","User"],"combobox":false,"required":false,"placeholder":"","show":true,"name":"sender","value":"User","display_name":"Sender Type","advanced":true,"dynamic":false,"info":"Type of sender.","title_case":false,"type":"str","_input_type":"DropdownInput"},"sender_name":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"sender_name","value":"User","display_name":"Sender Name","advanced":true,"input_types":["Message"],"dynamic":false,"info":"Name of the sender.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"session_id":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"session_id","value":"","display_name":"Session ID","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The session ID of the chat. If empty, the current session ID parameter will be used.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"should_store_message":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"should_store_message","value":true,"display_name":"Store Messages","advanced":true,"dynamic":false,"info":"Store the message in the history.","title_case":false,"type":"bool","_input_type":"BoolInput"},"text_color":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"text_color","value":"","display_name":"Text Color","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The text color of the name","title_case":false,"type":"str","_input_type":"MessageTextInput"}},"description":"Get chat inputs from the Playground.","icon":"MessagesSquare","base_classes":["Message"],"display_name":"Chat Input","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"message","display_name":"Message","method":"message_response","value":"__UNDEFINED__","cache":true}],"field_order":["input_value","should_store_message","sender","sender_name","session_id","files","background_color","chat_icon","text_color"],"beta":false,"legacy":false,"edited":false,"metadata":{},"tool_mode":false,"lf_version":"1.1.0"},"type":"ChatInput"},"dragging":false,"height":234,"id":"ChatInput-gqewG","position":{"x":428.5822388583747,"y":617.2410592842022},"positionAbsolute":{"x":428.5822388583747,"y":617.2410592842022},"selected":false,"type":"genericNode","width":320},{"data":{"description":"Retrieves stored chat messages from Langflow tables or an external memory.","display_name":"Chat Memory","id":"Memory-3CekQ","node":{"template":{"_type":"Component","memory":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"memory","value":"","display_name":"External Memory","advanced":false,"input_types":["BaseChatMessageHistory"],"dynamic":false,"info":"Retrieve messages from an external memory. If empty, it will use the Langflow tables.","title_case":false,"type":"other","_input_type":"HandleInput"},"code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langchain.memory import ConversationBufferMemory\n\nfrom langflow.custom import Component\nfrom langflow.field_typing import BaseChatMemory\nfrom langflow.helpers.data import data_to_text\nfrom langflow.inputs import HandleInput\nfrom langflow.io import DropdownInput, IntInput, MessageTextInput, MultilineInput, Output\nfrom langflow.memory import LCBuiltinChatMemory, get_messages\nfrom langflow.schema import Data\nfrom langflow.schema.message import Message\nfrom langflow.utils.constants import MESSAGE_SENDER_AI, MESSAGE_SENDER_USER\n\n\nclass MemoryComponent(Component):\n    display_name = \"Message History\"\n    description = \"Retrieves stored chat messages from Langflow tables or an external memory.\"\n    icon = \"message-square-more\"\n    name = \"Memory\"\n\n    inputs = [\n        HandleInput(\n            name=\"memory\",\n            display_name=\"External Memory\",\n            input_types=[\"BaseChatMessageHistory\"],\n            info=\"Retrieve messages from an external memory. If empty, it will use the Langflow tables.\",\n        ),\n        DropdownInput(\n            name=\"sender\",\n            display_name=\"Sender Type\",\n            options=[MESSAGE_SENDER_AI, MESSAGE_SENDER_USER, \"Machine and User\"],\n            value=\"Machine and User\",\n            info=\"Filter by sender type.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"sender_name\",\n            display_name=\"Sender Name\",\n            info=\"Filter by sender name.\",\n            advanced=True,\n        ),\n        IntInput(\n            name=\"n_messages\",\n            display_name=\"Number of Messages\",\n            value=100,\n            info=\"Number of messages to retrieve.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"session_id\",\n            display_name=\"Session ID\",\n            info=\"The session ID of the chat. If empty, the current session ID parameter will be used.\",\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"order\",\n            display_name=\"Order\",\n            options=[\"Ascending\", \"Descending\"],\n            value=\"Ascending\",\n            info=\"Order of the messages.\",\n            advanced=True,\n        ),\n        MultilineInput(\n            name=\"template\",\n            display_name=\"Template\",\n            info=\"The template to use for formatting the data. \"\n            \"It can contain the keys {text}, {sender} or any other key in the message data.\",\n            value=\"{sender_name}: {text}\",\n            advanced=True,\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Data\", name=\"messages\", method=\"retrieve_messages\"),\n        Output(display_name=\"Text\", name=\"messages_text\", method=\"retrieve_messages_as_text\"),\n    ]\n\n    def retrieve_messages(self) -> Data:\n        sender = self.sender\n        sender_name = self.sender_name\n        session_id = self.session_id\n        n_messages = self.n_messages\n        order = \"DESC\" if self.order == \"Descending\" else \"ASC\"\n\n        if sender == \"Machine and User\":\n            sender = None\n\n        if self.memory:\n            # override session_id\n            self.memory.session_id = session_id\n\n            stored = self.memory.messages\n            # langchain memories are supposed to return messages in ascending order\n            if order == \"DESC\":\n                stored = stored[::-1]\n            if n_messages:\n                stored = stored[:n_messages]\n            stored = [Message.from_lc_message(m) for m in stored]\n            if sender:\n                expected_type = MESSAGE_SENDER_AI if sender == MESSAGE_SENDER_AI else MESSAGE_SENDER_USER\n                stored = [m for m in stored if m.type == expected_type]\n        else:\n            stored = get_messages(\n                sender=sender,\n                sender_name=sender_name,\n                session_id=session_id,\n                limit=n_messages,\n                order=order,\n            )\n        self.status = stored\n        return stored\n\n    def retrieve_messages_as_text(self) -> Message:\n        stored_text = data_to_text(self.template, self.retrieve_messages())\n        self.status = stored_text\n        return Message(text=stored_text)\n\n    def build_lc_memory(self) -> BaseChatMemory:\n        chat_memory = self.memory or LCBuiltinChatMemory(flow_id=self.flow_id, session_id=self.session_id)\n        return ConversationBufferMemory(chat_memory=chat_memory)\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"n_messages":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"n_messages","value":100,"display_name":"Number of Messages","advanced":true,"dynamic":false,"info":"Number of messages to retrieve.","title_case":false,"type":"int","_input_type":"IntInput"},"order":{"tool_mode":false,"trace_as_metadata":true,"options":["Ascending","Descending"],"combobox":false,"required":false,"placeholder":"","show":true,"name":"order","value":"Ascending","display_name":"Order","advanced":true,"dynamic":false,"info":"Order of the messages.","title_case":false,"type":"str","_input_type":"DropdownInput"},"sender":{"tool_mode":false,"trace_as_metadata":true,"options":["Machine","User","Machine and User"],"combobox":false,"required":false,"placeholder":"","show":true,"name":"sender","value":"Machine and User","display_name":"Sender Type","advanced":true,"dynamic":false,"info":"Filter by sender type.","title_case":false,"type":"str","_input_type":"DropdownInput"},"sender_name":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"sender_name","value":"","display_name":"Sender Name","advanced":true,"input_types":["Message"],"dynamic":false,"info":"Filter by sender name.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"session_id":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"session_id","value":"","display_name":"Session ID","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The session ID of the chat. If empty, the current session ID parameter will be used.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"template":{"tool_mode":false,"trace_as_input":true,"multiline":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"template","value":"{sender_name}: {text}","display_name":"Template","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The template to use for formatting the data. It can contain the keys {text}, {sender} or any other key in the message data.","title_case":false,"type":"str","_input_type":"MultilineInput"}},"description":"Retrieves stored chat messages from Langflow tables or an external memory.","icon":"message-square-more","base_classes":["Data","Message"],"display_name":"Chat Memory","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Data"],"selected":"Data","name":"messages","display_name":"Data","method":"retrieve_messages","value":"__UNDEFINED__","cache":true},{"types":["Message"],"selected":"Message","name":"messages_text","display_name":"Text","method":"retrieve_messages_as_text","value":"__UNDEFINED__","cache":true}],"field_order":["memory","sender","sender_name","n_messages","session_id","order","template"],"beta":false,"legacy":false,"edited":false,"metadata":{},"tool_mode":false,"lf_version":"1.1.0"},"type":"Memory"},"dragging":false,"height":264,"id":"Memory-3CekQ","position":{"x":4120.699123033176,"y":1346.5898659986117},"positionAbsolute":{"x":4120.699123033176,"y":1346.5898659986117},"selected":false,"type":"genericNode","width":320},{"id":"MyLLMModel-MNx8O","type":"genericNode","position":{"x":1611.5441802765818,"y":-808.7408792282913},"data":{"type":"MyLLMModel","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from typing import List, Optional, Any\n\nimport requests\nfrom langchain.callbacks.manager import CallbackManagerForLLMRun\nfrom langchain.schema import LLMResult, Generation\nfrom langchain_core.language_models import BaseLLM\nfrom langflow.base.models.model import LCModelComponent\nfrom langflow.field_typing import LanguageModel\nfrom langflow.inputs import (\n    StrInput,\n    FloatInput,\n    IntInput,\n)\n\nimport re\n\nclass CustomLLMComponent(LCModelComponent):\n    display_name = \"Generative LLM\"\n    description = \"Generates text using a custom LLM server.\"\n    icon = \"chat\"\n    name = \"MyLLMModel\"\n\n    inputs = LCModelComponent._base_inputs + [\n        StrInput(\n            name=\"server_url\",\n            display_name=\"Server URL\",\n            info=\"URL for the custom server.\",\n            value=\"https://ABC.loca.lt\",\n        ),\n        FloatInput(\n            name=\"temperature\",\n            display_name=\"Temperature\",\n            value=0.7,\n            info=\"Sampling temperature for text generation.\",\n            advanced=False,\n        ),\n        IntInput(\n            name=\"max_new_tokens\",\n            display_name=\"Max New Tokens\",\n            value=50,\n            info=\"Maximum number of tokens to generate.\",\n            advanced=False,\n        ),\n    ]\n\n    def build_model(self) -> LanguageModel:\n        # Instantiate CustomLLM with the appropriate parameters\n        return self.CustomLLM(\n            server_url=self.server_url + \"/generate\",\n            temperature=self.temperature,\n            max_new_tokens=self.max_new_tokens\n        )\n\n    class CustomLLM(BaseLLM):\n        \"\"\"Wrapper class for custom LLM model to comply with the LanguageModel interface.\"\"\"\n\n        # Define fields as class-level variables\n        server_url: str\n        temperature: float\n        max_new_tokens: int\n\n        def _call(\n                self,\n                prompt: str,\n                stop: Optional[List[str]] = None,  # noqa\n                run_manager: Optional[CallbackManagerForLLMRun] = None,  # noqa\n                **kwargs: Any,  # noqa\n        ) -> str:\n            \"\"\"Generate text from the custom LLM model.\"\"\"\n            payload = {\n                \"text\": prompt,\n                \"temperature\": self.temperature,\n                \"max_new_tokens\": self.max_new_tokens\n            }\n            headers = {\n                \"Content-Type\": \"application/json\"\n            }\n            try:\n                response = requests.post(self.server_url, json=payload, headers=headers)\n                response.raise_for_status()\n                result = response.json()\n                return result.get(\"generated_text\", \"No generated text returned.\")\n            except requests.RequestException as e:\n                return f\"Error generating text: {e}\"\n\n        def _generate(\n                self,\n                prompts: List[str],\n                stop: Optional[List[str]] = None,\n                run_manager: Optional[CallbackManagerForLLMRun] = None,\n                **kwargs: Any,\n        ) -> LLMResult:\n            \"\"\"Implements the required _generate method to handle batch generation.\"\"\"\n            generations = []\n            for prompt in prompts:\n                text = self._call(prompt, stop=stop, run_manager=run_manager, **kwargs)\n                generations.append([Generation(text=text)])\n\n            return LLMResult(generations=generations)\n\n        @property\n        def _llm_type(self) -> str:\n            return \"custom_llm\"\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"input_value":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"input_value","value":"","display_name":"Input","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageInput"},"max_new_tokens":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"max_new_tokens","value":20,"display_name":"Max New Tokens","advanced":false,"dynamic":false,"info":"Maximum number of tokens to generate.","title_case":false,"type":"int","_input_type":"IntInput","load_from_db":false},"server_url":{"trace_as_metadata":true,"load_from_db":true,"list":false,"required":false,"placeholder":"","show":true,"name":"server_url","value":"SERVER_URL","display_name":"Server URL","advanced":false,"dynamic":false,"info":"URL for the custom server.","title_case":false,"type":"str","_input_type":"StrInput"},"stream":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"stream","value":false,"display_name":"Stream","advanced":true,"dynamic":false,"info":"Stream the response from the model. Streaming works only in Chat.","title_case":false,"type":"bool","_input_type":"BoolInput"},"system_message":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"system_message","value":"","display_name":"System Message","advanced":true,"input_types":["Message"],"dynamic":false,"info":"System message to pass to the model.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"temperature":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"temperature","value":"0.1","display_name":"Temperature","advanced":false,"dynamic":false,"info":"Sampling temperature for text generation.","title_case":false,"type":"float","_input_type":"FloatInput","load_from_db":false}},"description":"Generates text using a custom LLM server.","icon":"chat","base_classes":["LanguageModel","Message"],"display_name":"Generative LLM","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"text_output","display_name":"Text","method":"text_response","value":"__UNDEFINED__","cache":true},{"types":["LanguageModel"],"selected":"LanguageModel","name":"model_output","display_name":"Language Model","method":"build_model","value":"__UNDEFINED__","cache":true}],"field_order":["input_value","system_message","stream","server_url","temperature","max_new_tokens"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"MyLLMModel-MNx8O"},"selected":false,"width":320,"height":543,"dragging":false,"positionAbsolute":{"x":1611.5441802765818,"y":-808.7408792282913}},{"id":"Prompt-zHbUd","type":"genericNode","position":{"x":1020.1670619028823,"y":-304.9818641612672},"data":{"type":"Prompt","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.base.prompts.api_utils import process_prompt_template\nfrom langflow.custom import Component\nfrom langflow.inputs.inputs import DefaultPromptField\nfrom langflow.io import Output, PromptInput\nfrom langflow.schema.message import Message\nfrom langflow.template.utils import update_template_values\n\n\nclass PromptComponent(Component):\n    display_name: str = \"Prompt\"\n    description: str = \"Create a prompt template with dynamic variables.\"\n    icon = \"prompts\"\n    trace_type = \"prompt\"\n    name = \"Prompt\"\n\n    inputs = [\n        PromptInput(name=\"template\", display_name=\"Template\"),\n    ]\n\n    outputs = [\n        Output(display_name=\"Prompt Message\", name=\"prompt\", method=\"build_prompt\"),\n    ]\n\n    async def build_prompt(self) -> Message:\n        prompt = Message.from_template(**self._attributes)\n        self.status = prompt.text\n        return prompt\n\n    def _update_template(self, frontend_node: dict):\n        prompt_template = frontend_node[\"template\"][\"template\"][\"value\"]\n        custom_fields = frontend_node[\"custom_fields\"]\n        frontend_node_template = frontend_node[\"template\"]\n        _ = process_prompt_template(\n            template=prompt_template,\n            name=\"template\",\n            custom_fields=custom_fields,\n            frontend_node_template=frontend_node_template,\n        )\n        return frontend_node\n\n    def post_code_processing(self, new_frontend_node: dict, current_frontend_node: dict):\n        \"\"\"This function is called after the code validation is done.\"\"\"\n        frontend_node = super().post_code_processing(new_frontend_node, current_frontend_node)\n        template = frontend_node[\"template\"][\"template\"][\"value\"]\n        # Kept it duplicated for backwards compatibility\n        _ = process_prompt_template(\n            template=template,\n            name=\"template\",\n            custom_fields=frontend_node[\"custom_fields\"],\n            frontend_node_template=frontend_node[\"template\"],\n        )\n        # Now that template is updated, we need to grab any values that were set in the current_frontend_node\n        # and update the frontend_node with those values\n        update_template_values(new_template=frontend_node, previous_template=current_frontend_node[\"template\"])\n        return frontend_node\n\n    def _get_fallback_input(self, **kwargs):\n        return DefaultPromptField(**kwargs)\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"template":{"tool_mode":false,"trace_as_input":true,"list":false,"required":false,"placeholder":"","show":true,"name":"template","value":"You are an English poetry expert with access to two specialized poetry databases:  \n1) **Similarity Retrieval** — for finding poems that resemble a given poem or poetic text, such as content, style, mood, or example. This retrieval is based on FAISS indexing of more than 13,000 poems.\n2) **Keyword Retrieval** — for finding poems based on specific keywords, which can be broad themes (e.g., \"nature,\" \"war\") or more specific nouns (e.g., \"tree,\" \"car\"). This retrieval is based on a NetworkX graph of more than 10,000 keywords.\n\n**Task:** Analyze the User Query and select the best retrieval action by choosing one of the options below:\n\n- **[A]: Skip Retrieval** — Select this if the User Query is conversational and doesn’t require poetry retrieval. Examples include:\n   - Greetings, thanks, farewells, or simple acknowledgments like \"Sounds good\" or \"Great idea.\"\n   - Follow-up questions about the current poems, such as \"Tell me more about its author\", or \"Explain this line further.\"\n\n- **[B]: Similarity Retrieval** — Select this if the User Query includes any poem or poetic language, seeking similarity in style, mood, or content. If you detect such text, you should always choose this option.\n\n- **[C]: Keyword Retrieval** — Select this if the User Query mentions specific keywords, such as themes (e.g., \"nature,\" \"war\"), nouns (e.g., \"tree,\" \"car\"), and named entities (e.g., \"America\", \"Victoria\").\n\nUser Query: {user_message}  \nAI: My choice is [","display_name":"Template","advanced":false,"dynamic":false,"info":"","title_case":false,"type":"prompt","_input_type":"PromptInput","load_from_db":false},"user_message":{"field_type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":true,"value":"","fileTypes":[],"file_path":"","name":"user_message","display_name":"user_message","advanced":false,"input_types":["Message","Text"],"dynamic":false,"info":"","load_from_db":false,"title_case":false,"type":"str"}},"description":"Create a prompt template with dynamic variables.","icon":"prompts","base_classes":["Message"],"display_name":"Prompt","documentation":"","custom_fields":{"template":["user_message"]},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"prompt","display_name":"Prompt Message","method":"build_prompt","value":"__UNDEFINED__","cache":true}],"field_order":["template"],"beta":false,"legacy":false,"edited":false,"metadata":{},"tool_mode":false,"lf_version":"1.1.0"},"id":"Prompt-zHbUd","description":"Create a prompt template with dynamic variables.","display_name":"Prompt"},"selected":false,"width":320,"height":347,"positionAbsolute":{"x":1020.1670619028823,"y":-304.9818641612672},"dragging":false},{"id":"NullRetriever-Snvzu","type":"genericNode","position":{"x":2907.169303516998,"y":-617.7301182419611},"data":{"type":"NullRetriever","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.custom import Component\nfrom langflow.io import MessageTextInput, Output\nfrom langflow.schema.message import Message\n\n\nclass SkipRetrieverComponent(Component):\n    display_name = \"Null Retriever\"\n    description = \"Null retriever returning an empty string (skipped retrival).\"\n    icon = \"space\"\n    name = \"NullRetriever\"\n\n    inputs = [\n        MessageTextInput(\n            name=\"selection\",\n            display_name=\"Retriever Selection\",\n        ),\n        MessageTextInput(\n            name=\"user_input\",\n            display_name=\"User Input\",\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Retrieved contents\", name=\"retrieved_contents\", method=\"retrieve\"),\n    ]\n\n    def retrieve(self) -> Message:\n        # Return empty string\n        self.status = \"\"\n        return Message(text=\"\")\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"selection":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"selection","value":"","display_name":"Retriever Selection","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageTextInput"},"user_input":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"user_input","value":"","display_name":"User Input","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageTextInput"}},"description":"Null retriever returning an empty string (skipped retrival).","icon":"space","base_classes":["Message"],"display_name":"Null Retriever","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"retrieved_contents","display_name":"Retrieved contents","method":"retrieve","value":"__UNDEFINED__","cache":true}],"field_order":["selection","user_input"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"NullRetriever-Snvzu"},"selected":false,"width":320,"height":340,"positionAbsolute":{"x":2907.169303516998,"y":-617.7301182419611},"dragging":false},{"id":"FaissRetriever-WRZJ8","type":"genericNode","position":{"x":2904.7264381326313,"y":-123.75594862962515},"data":{"type":"FaissRetriever","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.custom import Component\nfrom langflow.io import MessageTextInput, Output\nfrom langflow.schema.message import Message\n\n\nclass SkipRetrieverComponent(Component):\n    display_name = \"FAISS Retriever\"\n    description = \"FAISS retriever returning retrieved poems.\"\n    icon = \"FAISS\"\n    name = \"FaissRetriever\"\n\n    inputs = [\n        MessageTextInput(\n            name=\"selection\",\n            display_name=\"Retriever Selection\",\n        ),\n        MessageTextInput(\n            name=\"user_input\",\n            display_name=\"User Input\",\n        ),\n        StrInput(\n            name=\"server_url\",\n            display_name=\"Server URL\",\n            info=\"URL for the custom server.\",\n            value=\"https://ABC.loca.lt\",\n        ),\n        IntInput(\n            name=\"k\",\n            display_name=\"Poem Count\",\n            info=\"Number of retrieved poems.\",\n            value=1,\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Retrieved contents\", name=\"retrieved_text\", method=\"retrieve\"),\n    ]\n\n    def retrieve(self) -> Message:\n        if \"B\" not in self.selection:\n            # Return empty string\n            self.status = \"\"\n            return Message(text=\"\")\n        \n        payload = {\n            \"text\": self.user_input,\n            \"k\": self.k,\n        }\n        headers = {\n            \"Content-Type\": \"application/json\"\n        }\n        try:\n            response = requests.post(self.server_url + \"/retrieve_faiss\", json=payload, headers=headers)\n            response.raise_for_status()\n            result = response.json()\n            return result.get(\"retrieved_poems\", \"\")\n        except requests.RequestException as e:\n            return f\"Error generating text: {e}\"\n            \n    ","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"k":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"k","value":1,"display_name":"Poem Count","advanced":false,"dynamic":false,"info":"Number of retrieved poems.","title_case":false,"type":"int","_input_type":"IntInput"},"selection":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"selection","value":"","display_name":"Retriever Selection","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageTextInput"},"server_url":{"trace_as_metadata":true,"load_from_db":true,"list":false,"required":false,"placeholder":"","show":true,"name":"server_url","value":"SERVER_URL","display_name":"Server URL","advanced":false,"dynamic":false,"info":"URL for the custom server.","title_case":false,"type":"str","_input_type":"StrInput"},"user_input":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"user_input","value":"","display_name":"User Input","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageTextInput"}},"description":"Similarity-based retriever using FAISS.","icon":"FAISS","base_classes":["Message"],"display_name":"FAISS Retriever","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"retrieved_text","display_name":"Retrieved contents","method":"retrieve","value":"__UNDEFINED__","cache":true}],"field_order":["selection","user_input","server_url","k"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"FaissRetriever-WRZJ8"},"selected":false,"width":320,"height":495,"positionAbsolute":{"x":2904.7264381326313,"y":-123.75594862962515},"dragging":false},{"id":"Prompt-860cs","type":"genericNode","position":{"x":3531.957852436277,"y":-89.59830890758356},"data":{"type":"Prompt","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.base.prompts.api_utils import process_prompt_template\nfrom langflow.custom import Component\nfrom langflow.inputs.inputs import DefaultPromptField\nfrom langflow.io import Output, PromptInput\nfrom langflow.schema.message import Message\nfrom langflow.template.utils import update_template_values\n\n\nclass PromptComponent(Component):\n    display_name: str = \"Prompt\"\n    description: str = \"Create a prompt template with dynamic variables.\"\n    icon = \"prompts\"\n    trace_type = \"prompt\"\n    name = \"Prompt\"\n\n    inputs = [\n        PromptInput(name=\"template\", display_name=\"Template\"),\n    ]\n\n    outputs = [\n        Output(display_name=\"Prompt Message\", name=\"prompt\", method=\"build_prompt\"),\n    ]\n\n    async def build_prompt(self) -> Message:\n        prompt = Message.from_template(**self._attributes)\n        self.status = prompt.text\n        return prompt\n\n    def _update_template(self, frontend_node: dict):\n        prompt_template = frontend_node[\"template\"][\"template\"][\"value\"]\n        custom_fields = frontend_node[\"custom_fields\"]\n        frontend_node_template = frontend_node[\"template\"]\n        _ = process_prompt_template(\n            template=prompt_template,\n            name=\"template\",\n            custom_fields=custom_fields,\n            frontend_node_template=frontend_node_template,\n        )\n        return frontend_node\n\n    def post_code_processing(self, new_frontend_node: dict, current_frontend_node: dict):\n        \"\"\"This function is called after the code validation is done.\"\"\"\n        frontend_node = super().post_code_processing(new_frontend_node, current_frontend_node)\n        template = frontend_node[\"template\"][\"template\"][\"value\"]\n        # Kept it duplicated for backwards compatibility\n        _ = process_prompt_template(\n            template=template,\n            name=\"template\",\n            custom_fields=frontend_node[\"custom_fields\"],\n            frontend_node_template=frontend_node[\"template\"],\n        )\n        # Now that template is updated, we need to grab any values that were set in the current_frontend_node\n        # and update the frontend_node with those values\n        update_template_values(new_template=frontend_node, previous_template=current_frontend_node[\"template\"])\n        return frontend_node\n\n    def _get_fallback_input(self, **kwargs):\n        return DefaultPromptField(**kwargs)\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"template":{"tool_mode":false,"trace_as_input":true,"list":false,"required":false,"placeholder":"","show":true,"name":"template","value":"{first}{second}{third}","display_name":"Template","advanced":false,"dynamic":false,"info":"","title_case":false,"type":"prompt","_input_type":"PromptInput","load_from_db":false},"first":{"field_type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":true,"value":"","fileTypes":[],"file_path":"","name":"first","display_name":"first","advanced":false,"input_types":["Message","Text"],"dynamic":false,"info":"","load_from_db":false,"title_case":false,"type":"str"},"second":{"field_type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":true,"value":"","fileTypes":[],"file_path":"","name":"second","display_name":"second","advanced":false,"input_types":["Message","Text"],"dynamic":false,"info":"","load_from_db":false,"title_case":false,"type":"str"},"third":{"field_type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":true,"value":"","fileTypes":[],"file_path":"","name":"third","display_name":"third","advanced":false,"input_types":["Message","Text"],"dynamic":false,"info":"","load_from_db":false,"title_case":false,"type":"str"}},"description":"Create a prompt template with dynamic variables.","icon":"prompts","base_classes":["Message"],"display_name":"Prompt","documentation":"","custom_fields":{"template":["first","second","third"]},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"prompt","display_name":"Prompt Message","method":"build_prompt","value":"__UNDEFINED__","cache":true}],"field_order":["template"],"beta":false,"legacy":false,"edited":false,"metadata":{},"tool_mode":false,"lf_version":"1.1.0"},"id":"Prompt-860cs","description":"Create a prompt template with dynamic variables.","display_name":"Prompt"},"selected":false,"width":320,"height":520,"dragging":false,"positionAbsolute":{"x":3531.957852436277,"y":-89.59830890758356}},{"id":"SelectionParser-JQ9Bk","type":"genericNode","position":{"x":2254.2355840904424,"y":-651.2684089486299},"data":{"type":"SelectionParser","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"import re\nfrom langflow.custom import Component\nfrom langflow.io import MessageTextInput, Output\nfrom langflow.schema.message import Message\n\nclass SelectionParserComponent(Component):\n    display_name = \"Selection Parser\"\n    description = \"Parse retriever selection.\"\n    icon = \"prompts\"\n    name = \"SelectionParser\"\n\n    inputs = [\n        MessageTextInput(\n            name=\"selection\",\n            display_name=\"Selection\",\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Parsed Selection\", name=\"parsed\", method=\"parse\"),\n    ]\n\n    def parse(self) -> Message:\n        # Retrieve input text from the `selection` input\n        selection_text = self.selection  # Accessing the input value\n        \n        # Check if the first two characters are in the correct format\n        if selection_text[0:2] in [\"A]\", \"B]\", \"C]\"]:\n            choice = selection_text[0]  # Extracts \"A\", \"B\", or \"C\"\n            parsed = f\"{choice}\"  # Formats as [A], [B], or [C]\n        \n        # Fallback: use regex to find any standalone A, B, or C within the text\n        elif re.search(r\"\\bA\\b|\\bB\\b|\\bC\\b\", selection_text):\n            match = re.search(r\"\\bA\\b|\\bB\\b|\\bC\\b\", selection_text)\n            choice = match.group()  # Extracts \"A\", \"B\", or \"C\"\n            parsed = f\"{choice}\"  # Formats as A, B, or C\n        \n        # If no valid format is found, default to \"A\"\n        else:\n            parsed = \"A\"\n\n        self.status = parsed\n        return Message(text=parsed)\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"selection":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"selection","value":"","display_name":"Selection","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageTextInput"}},"description":"Parse retriever selection result.","icon":"prompts","base_classes":["Message"],"display_name":"Selection Parser","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"parsed","display_name":"Parsed Selection","method":"parse","value":"__UNDEFINED__","cache":true}],"field_order":["selection"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"SelectionParser-JQ9Bk"},"selected":false,"width":320,"height":234,"dragging":false,"positionAbsolute":{"x":2254.2355840904424,"y":-651.2684089486299}},{"id":"NetworkXRetriever-rbGxV","type":"genericNode","position":{"x":2905.1400944686457,"y":527.4317464093233},"data":{"type":"NetworkXRetriever","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.custom import Component\nfrom langflow.io import MessageTextInput, Output\nfrom langflow.schema.message import Message\n\n\nclass SkipRetrieverComponent(Component):\n    display_name = \"NetworkX Retriever\"\n    description = \"NetworkX retriever returning retrieved poems.\"\n    icon = \"network\"\n    name = \"NetworkXRetriever\"\n\n    inputs = [\n        MessageTextInput(\n            name=\"selection\",\n            display_name=\"Retriever Selection\",\n        ),\n        MessageTextInput(\n            name=\"user_input\",\n            display_name=\"User Input\",\n        ),\n        StrInput(\n            name=\"server_url\",\n            display_name=\"Server URL\",\n            info=\"URL for the custom server.\",\n            value=\"https://ABC.loca.lt\",\n        ),\n        IntInput(\n            name=\"k\",\n            display_name=\"Poem Count\",\n            info=\"Number of retrieved poems.\",\n            value=1,\n        ),\n        IntInput(\n            name=\"depth\",\n            display_name=\"Depth\",\n            info=\"Depth for graph search.\",\n            value=2,\n        ),\n        FloatInput(\n            name=\"depth_decay\",\n            display_name=\"Depth Decay\",\n            info=\"The factor by which the score decays along depth.\",\n            value=0.5,\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Retrieved contents\", name=\"retrieved_text\", method=\"retrieve\"),\n    ]\n\n    def retrieve(self) -> Message:\n        if \"C\" not in self.selection:\n            # Return empty string\n            self.status = \"\"\n            return Message(text=\"\")\n        \n        payload = {\n            \"text\": self.user_input,\n            \"k\": self.k,\n            \"depth\": self.depth,\n            \"depth_decay\": self.depth_decay\n        }\n        headers = {\n            \"Content-Type\": \"application/json\"\n        }\n        try:\n            response = requests.post(self.server_url + \"/retrieve_nx_graph\", json=payload, headers=headers)\n            response.raise_for_status()\n            result = response.json()\n            return result.get(\"retrieved_poems\", \"\")\n        except requests.RequestException as e:\n            return f\"Error generating text: {e}\"\n            \n    ","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"depth":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"depth","value":2,"display_name":"Depth","advanced":false,"dynamic":false,"info":"Depth for graph search.","title_case":false,"type":"int","_input_type":"IntInput"},"depth_decay":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"depth_decay","value":0.5,"display_name":"Depth Decay","advanced":false,"dynamic":false,"info":"The factor by which the score decays along depth.","title_case":false,"type":"float","_input_type":"FloatInput"},"k":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"k","value":1,"display_name":"Poem Count","advanced":false,"dynamic":false,"info":"Number of retrieved poems.","title_case":false,"type":"int","_input_type":"IntInput"},"selection":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"selection","value":"","display_name":"Retriever Selection","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageTextInput"},"server_url":{"trace_as_metadata":true,"load_from_db":true,"list":false,"required":false,"placeholder":"","show":true,"name":"server_url","value":"SERVER_URL","display_name":"Server URL","advanced":false,"dynamic":false,"info":"URL for the custom server.","title_case":false,"type":"str","_input_type":"StrInput"},"user_input":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"user_input","value":"","display_name":"User Input","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageTextInput"}},"description":"NetworkX retriever returning retrieved poems.","icon":"network","base_classes":["Message"],"display_name":"NetworkX Retriever","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"retrieved_text","display_name":"Retrieved contents","method":"retrieve","value":"__UNDEFINED__","cache":true}],"field_order":["selection","user_input","server_url","k","depth","depth_decay"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"NetworkXRetriever-rbGxV"},"selected":false,"width":320,"height":668,"positionAbsolute":{"x":2905.1400944686457,"y":527.4317464093233},"dragging":false},{"id":"TextOutput-Xryan","type":"genericNode","position":{"x":4154.470247345339,"y":-483.81604581483236},"data":{"type":"TextOutput","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.base.io.text import TextComponent\nfrom langflow.io import MultilineInput, Output\nfrom langflow.schema.message import Message\n\n\nclass TextOutputComponent(TextComponent):\n    display_name = \"Text Output\"\n    description = \"Display a text output in the Playground.\"\n    icon = \"type\"\n    name = \"TextOutput\"\n\n    inputs = [\n        MultilineInput(\n            name=\"input_value\",\n            display_name=\"Text\",\n            info=\"Text to be passed as output.\",\n        ),\n    ]\n    outputs = [\n        Output(display_name=\"Text\", name=\"text\", method=\"text_response\"),\n    ]\n\n    def text_response(self) -> Message:\n        text=self.input_value or \"No retrival.\"\n        message = Message(\n            text=text,\n        )\n        self.status = self.input_value\n        return message\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"input_value":{"trace_as_input":true,"multiline":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"input_value","value":"","display_name":"Text","advanced":false,"input_types":["Message"],"dynamic":false,"info":"Text to be passed as output.","title_case":false,"type":"str","_input_type":"MultilineInput"}},"description":"Display retrieved poems.","icon":"type","base_classes":["Message"],"display_name":"Retrieved Poems","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"text","display_name":"Text","method":"text_response","value":"__UNDEFINED__","cache":true}],"field_order":["input_value"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"TextOutput-Xryan"},"selected":false,"width":320,"height":234,"positionAbsolute":{"x":4154.470247345339,"y":-483.81604581483236},"dragging":false},{"id":"Prompt-00f64","type":"genericNode","position":{"x":4800.052921583509,"y":1378.4356377989136},"data":{"type":"Prompt","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.base.prompts.api_utils import process_prompt_template\nfrom langflow.custom import Component\nfrom langflow.inputs.inputs import DefaultPromptField\nfrom langflow.io import Output, PromptInput\nfrom langflow.schema.message import Message\nfrom langflow.template.utils import update_template_values\n\n\nclass PromptComponent(Component):\n    display_name: str = \"Prompt\"\n    description: str = \"Create a prompt template with dynamic variables.\"\n    icon = \"prompts\"\n    trace_type = \"prompt\"\n    name = \"Prompt\"\n\n    inputs = [\n        PromptInput(name=\"template\", display_name=\"Template\"),\n    ]\n\n    outputs = [\n        Output(display_name=\"Prompt Message\", name=\"prompt\", method=\"build_prompt\"),\n    ]\n\n    async def build_prompt(self) -> Message:\n        prompt = Message.from_template(**self._attributes)\n        self.status = prompt.text\n        return prompt\n\n    def _update_template(self, frontend_node: dict):\n        prompt_template = frontend_node[\"template\"][\"template\"][\"value\"]\n        custom_fields = frontend_node[\"custom_fields\"]\n        frontend_node_template = frontend_node[\"template\"]\n        _ = process_prompt_template(\n            template=prompt_template,\n            name=\"template\",\n            custom_fields=custom_fields,\n            frontend_node_template=frontend_node_template,\n        )\n        return frontend_node\n\n    def post_code_processing(self, new_frontend_node: dict, current_frontend_node: dict):\n        \"\"\"This function is called after the code validation is done.\"\"\"\n        frontend_node = super().post_code_processing(new_frontend_node, current_frontend_node)\n        template = frontend_node[\"template\"][\"template\"][\"value\"]\n        # Kept it duplicated for backwards compatibility\n        _ = process_prompt_template(\n            template=template,\n            name=\"template\",\n            custom_fields=frontend_node[\"custom_fields\"],\n            frontend_node_template=frontend_node[\"template\"],\n        )\n        # Now that template is updated, we need to grab any values that were set in the current_frontend_node\n        # and update the frontend_node with those values\n        update_template_values(new_template=frontend_node, previous_template=current_frontend_node[\"template\"])\n        return frontend_node\n\n    def _get_fallback_input(self, **kwargs):\n        return DefaultPromptField(**kwargs)\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"template":{"tool_mode":false,"trace_as_input":true,"list":false,"required":false,"placeholder":"","show":true,"name":"template","value":"You are an English poetry professor with deep knowledge of poetic forms, themes, and historical context. Your task is to assist users by providing insightful and relevant responses to their queries about poetry. \n\n{input_retrieved_poems}\n\n---------------------------------\n\n{memory}\n\nAI:\n","display_name":"Template","advanced":false,"dynamic":false,"info":"","title_case":false,"type":"prompt","_input_type":"PromptInput","load_from_db":false},"input_retrieved_poems":{"field_type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":true,"value":"","fileTypes":[],"file_path":"","name":"input_retrieved_poems","display_name":"input_retrieved_poems","advanced":false,"input_types":["Message","Text"],"dynamic":false,"info":"","load_from_db":false,"title_case":false,"type":"str"},"memory":{"field_type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":true,"value":"","fileTypes":[],"file_path":"","name":"memory","display_name":"memory","advanced":false,"input_types":["Message","Text"],"dynamic":false,"info":"","load_from_db":false,"title_case":false,"type":"str"}},"description":"Create a prompt template with dynamic variables.","icon":"prompts","base_classes":["Message"],"display_name":"Prompt","documentation":"","custom_fields":{"template":["input_retrieved_poems","memory"]},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"prompt","display_name":"Prompt Message","method":"build_prompt","value":"__UNDEFINED__","cache":true}],"field_order":["template"],"beta":false,"legacy":false,"edited":false,"metadata":{},"tool_mode":false,"lf_version":"1.1.0"},"id":"Prompt-00f64","description":"Create a prompt template with dynamic variables.","display_name":"Prompt"},"selected":false,"width":320,"height":433,"positionAbsolute":{"x":4800.052921583509,"y":1378.4356377989136},"dragging":false},{"id":"PoemPrompt-3ZbNY","type":"genericNode","position":{"x":4128.379748444478,"y":891.4739183489241},"data":{"type":"PoemPrompt","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.custom import Component\nfrom langflow.io import MessageTextInput, Output\nfrom langflow.schema.message import Message\n\nclass PoemPromptComponent(Component):\n    display_name = \"Poem Prompt\"\n    description = \"Parse retrieved poems into a prompt.\"\n    icon = \"prompts\"\n    name = \"PoemPrompt\"\n\n    inputs = [\n        MessageTextInput(\n            name=\"poems\",\n            display_name=\"Retrieved Poems\",\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Poem Prompt\", name=\"parsed\", method=\"parse\"),\n    ]\n\n    def parse(self) -> Message:\n        # Access the input poems directly from inputs\n        poems = self.poems\n        \n        # Create the parsed prompt based on whether poems are provided\n        if poems:\n            parsed = (\n                \"Based on the user query, your secretary has retrieved the following poems to help enrich your response. \"\n                \"Use these to provide relevant insights, analyze themes, or add context for the user’s query. \"\n                \"Note: Your secretary will present the original poems to the user, so you do not need to include them verbatim in your answer.\\n\\n\" + poems\n            )\n        else:\n            parsed = \"\"\n        \n        # Optionally set status, if needed for component feedback\n        self.status = parsed\n        \n        return Message(text=parsed)\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"poems":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"poems","value":"","display_name":"Retrieved Poems","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageTextInput"}},"description":"Parse retrieved poems into a prompt.","icon":"prompts","base_classes":["Message"],"display_name":"Poem Parser","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"parsed","display_name":"Poem Prompt","method":"parse","value":"__UNDEFINED__","cache":true}],"field_order":["poems"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"PoemPrompt-3ZbNY"},"selected":false,"width":320,"height":234,"positionAbsolute":{"x":4128.379748444478,"y":891.4739183489241},"dragging":false},{"id":"MyLLMModel-iVF87","type":"genericNode","position":{"x":5388.4590658000325,"y":1373.82627516581},"data":{"type":"MyLLMModel","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from typing import List, Optional, Any\n\nimport requests\nfrom langchain.callbacks.manager import CallbackManagerForLLMRun\nfrom langchain.schema import LLMResult, Generation\nfrom langchain_core.language_models import BaseLLM\nfrom langflow.base.models.model import LCModelComponent\nfrom langflow.field_typing import LanguageModel\nfrom langflow.inputs import (\n    StrInput,\n    FloatInput,\n    IntInput,\n)\n\nimport re\n\nclass CustomLLMComponent(LCModelComponent):\n    display_name = \"Generative LLM\"\n    description = \"Generates text using a custom LLM server.\"\n    icon = \"chat\"\n    name = \"MyLLMModel\"\n\n    inputs = LCModelComponent._base_inputs + [\n        StrInput(\n            name=\"server_url\",\n            display_name=\"Server URL\",\n            info=\"URL for the custom server.\",\n            value=\"https://ABC.loca.lt\",\n        ),\n        FloatInput(\n            name=\"temperature\",\n            display_name=\"Temperature\",\n            value=0.7,\n            info=\"Sampling temperature for text generation.\",\n            advanced=False,\n        ),\n        IntInput(\n            name=\"max_new_tokens\",\n            display_name=\"Max New Tokens\",\n            value=50,\n            info=\"Maximum number of tokens to generate.\",\n            advanced=False,\n        ),\n    ]\n\n    def build_model(self) -> LanguageModel:\n        # Instantiate CustomLLM with the appropriate parameters\n        return self.CustomLLM(\n            server_url=self.server_url + \"/generate\",\n            temperature=self.temperature,\n            max_new_tokens=self.max_new_tokens\n        )\n\n    class CustomLLM(BaseLLM):\n        \"\"\"Wrapper class for custom LLM model to comply with the LanguageModel interface.\"\"\"\n\n        # Define fields as class-level variables\n        server_url: str\n        temperature: float\n        max_new_tokens: int\n\n        def _call(\n                self,\n                prompt: str,\n                stop: Optional[List[str]] = None,  # noqa\n                run_manager: Optional[CallbackManagerForLLMRun] = None,  # noqa\n                **kwargs: Any,  # noqa\n        ) -> str:\n            \"\"\"Generate text from the custom LLM model.\"\"\"\n            payload = {\n                \"text\": prompt,\n                \"temperature\": self.temperature,\n                \"max_new_tokens\": self.max_new_tokens\n            }\n            headers = {\n                \"Content-Type\": \"application/json\"\n            }\n            try:\n                response = requests.post(self.server_url, json=payload, headers=headers)\n                response.raise_for_status()\n                result = response.json()\n                return result.get(\"generated_text\", \"No generated text returned.\")\n            except requests.RequestException as e:\n                return f\"Error generating text: {e}\"\n\n        def _generate(\n                self,\n                prompts: List[str],\n                stop: Optional[List[str]] = None,\n                run_manager: Optional[CallbackManagerForLLMRun] = None,\n                **kwargs: Any,\n        ) -> LLMResult:\n            \"\"\"Implements the required _generate method to handle batch generation.\"\"\"\n            generations = []\n            for prompt in prompts:\n                text = self._call(prompt, stop=stop, run_manager=run_manager, **kwargs)\n                generations.append([Generation(text=text)])\n\n            return LLMResult(generations=generations)\n\n        @property\n        def _llm_type(self) -> str:\n            return \"custom_llm\"\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"input_value":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"input_value","value":"","display_name":"Input","advanced":false,"input_types":["Message"],"dynamic":false,"info":"","title_case":false,"type":"str","_input_type":"MessageInput"},"max_new_tokens":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"max_new_tokens","value":200,"display_name":"Max New Tokens","advanced":false,"dynamic":false,"info":"Maximum number of tokens to generate.","title_case":false,"type":"int","_input_type":"IntInput","load_from_db":false},"server_url":{"trace_as_metadata":true,"load_from_db":true,"list":false,"required":false,"placeholder":"","show":true,"name":"server_url","value":"SERVER_URL","display_name":"Server URL","advanced":false,"dynamic":false,"info":"URL for the custom server.","title_case":false,"type":"str","_input_type":"StrInput"},"stream":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"stream","value":false,"display_name":"Stream","advanced":true,"dynamic":false,"info":"Stream the response from the model. Streaming works only in Chat.","title_case":false,"type":"bool","_input_type":"BoolInput"},"system_message":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"system_message","value":"","display_name":"System Message","advanced":true,"input_types":["Message"],"dynamic":false,"info":"System message to pass to the model.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"temperature":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"temperature","value":0.5,"display_name":"Temperature","advanced":false,"dynamic":false,"info":"Sampling temperature for text generation.","title_case":false,"type":"float","_input_type":"FloatInput","load_from_db":false}},"description":"Generates text using a custom LLM server.","icon":"chat","base_classes":["LanguageModel","Message"],"display_name":"Generative LLM","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"text_output","display_name":"Text","method":"text_response","value":"__UNDEFINED__","cache":true},{"types":["LanguageModel"],"selected":"LanguageModel","name":"model_output","display_name":"Language Model","method":"build_model","value":"__UNDEFINED__","cache":true}],"field_order":["input_value","system_message","stream","server_url","temperature","max_new_tokens"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"MyLLMModel-iVF87"},"selected":false,"width":320,"height":543,"positionAbsolute":{"x":5388.4590658000325,"y":1373.82627516581},"dragging":false},{"id":"ChatOutput-gRH3m","type":"genericNode","position":{"x":6431.647626448245,"y":1477.712405521416},"data":{"type":"ChatOutput","node":{"template":{"_type":"Component","background_color":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"background_color","value":"","display_name":"Background Color","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The background color of the icon.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"chat_icon":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"chat_icon","value":"","display_name":"Icon","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The icon of the message.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.base.io.chat import ChatComponent\nfrom langflow.inputs import BoolInput\nfrom langflow.io import DropdownInput, MessageInput, MessageTextInput, Output\nfrom langflow.schema.message import Message\nfrom langflow.schema.properties import Source\nfrom langflow.utils.constants import MESSAGE_SENDER_AI, MESSAGE_SENDER_NAME_AI, MESSAGE_SENDER_USER\n\n\nclass ChatOutput(ChatComponent):\n    display_name = \"Chat Output\"\n    description = \"Display a chat message in the Playground.\"\n    icon = \"MessagesSquare\"\n    name = \"ChatOutput\"\n\n    inputs = [\n        MessageInput(\n            name=\"input_value\",\n            display_name=\"Text\",\n            info=\"Message to be passed as output.\",\n        ),\n        BoolInput(\n            name=\"should_store_message\",\n            display_name=\"Store Messages\",\n            info=\"Store the message in the history.\",\n            value=True,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"sender\",\n            display_name=\"Sender Type\",\n            options=[MESSAGE_SENDER_AI, MESSAGE_SENDER_USER],\n            value=MESSAGE_SENDER_AI,\n            advanced=True,\n            info=\"Type of sender.\",\n        ),\n        MessageTextInput(\n            name=\"sender_name\",\n            display_name=\"Sender Name\",\n            info=\"Name of the sender.\",\n            value=MESSAGE_SENDER_NAME_AI,\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"session_id\",\n            display_name=\"Session ID\",\n            info=\"The session ID of the chat. If empty, the current session ID parameter will be used.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"data_template\",\n            display_name=\"Data Template\",\n            value=\"{text}\",\n            advanced=True,\n            info=\"Template to convert Data to Text. If left empty, it will be dynamically set to the Data's text key.\",\n        ),\n        MessageTextInput(\n            name=\"background_color\",\n            display_name=\"Background Color\",\n            info=\"The background color of the icon.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"chat_icon\",\n            display_name=\"Icon\",\n            info=\"The icon of the message.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"text_color\",\n            display_name=\"Text Color\",\n            info=\"The text color of the name\",\n            advanced=True,\n        ),\n    ]\n    outputs = [\n        Output(\n            display_name=\"Message\",\n            name=\"message\",\n            method=\"message_response\",\n        ),\n    ]\n\n    def _build_source(self, _id: str | None, display_name: str | None, source: str | None) -> Source:\n        source_dict = {}\n        if _id:\n            source_dict[\"id\"] = _id\n        if display_name:\n            source_dict[\"display_name\"] = display_name\n        if source:\n            source_dict[\"source\"] = source\n        return Source(**source_dict)\n\n    def message_response(self) -> Message:\n        _source, _icon, _display_name, _source_id = self.get_properties_from_source_component()\n        _background_color = self.background_color\n        _text_color = self.text_color\n        if self.chat_icon:\n            _icon = self.chat_icon\n        message = self.input_value if isinstance(self.input_value, Message) else Message(text=self.input_value)\n        message.sender = self.sender\n        message.sender_name = self.sender_name\n        message.session_id = self.session_id\n        message.flow_id = self.graph.flow_id if hasattr(self, \"graph\") else None\n        message.properties.source = self._build_source(_source_id, _display_name, _source)\n        message.properties.icon = _icon\n        message.properties.background_color = _background_color\n        message.properties.text_color = _text_color\n        if self.session_id and isinstance(message, Message) and self.should_store_message:\n            stored_message = self.send_message(\n                message,\n            )\n            self.message.value = stored_message\n            message = stored_message\n\n        self.status = message\n        return message\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"data_template":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"data_template","value":"{text}","display_name":"Data Template","advanced":true,"input_types":["Message"],"dynamic":false,"info":"Template to convert Data to Text. If left empty, it will be dynamically set to the Data's text key.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"input_value":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"input_value","value":"","display_name":"Text","advanced":false,"input_types":["Message"],"dynamic":false,"info":"Message to be passed as output.","title_case":false,"type":"str","_input_type":"MessageInput"},"sender":{"tool_mode":false,"trace_as_metadata":true,"options":["Machine","User"],"combobox":false,"required":false,"placeholder":"","show":true,"name":"sender","value":"Machine","display_name":"Sender Type","advanced":true,"dynamic":false,"info":"Type of sender.","title_case":false,"type":"str","_input_type":"DropdownInput"},"sender_name":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"sender_name","value":"AI","display_name":"Sender Name","advanced":true,"input_types":["Message"],"dynamic":false,"info":"Name of the sender.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"session_id":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"session_id","value":"","display_name":"Session ID","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The session ID of the chat. If empty, the current session ID parameter will be used.","title_case":false,"type":"str","_input_type":"MessageTextInput"},"should_store_message":{"trace_as_metadata":true,"list":false,"required":false,"placeholder":"","show":true,"name":"should_store_message","value":true,"display_name":"Store Messages","advanced":true,"dynamic":false,"info":"Store the message in the history.","title_case":false,"type":"bool","_input_type":"BoolInput"},"text_color":{"tool_mode":false,"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"text_color","value":"","display_name":"Text Color","advanced":true,"input_types":["Message"],"dynamic":false,"info":"The text color of the name","title_case":false,"type":"str","_input_type":"MessageTextInput"}},"description":"Display a chat message in the Playground.","icon":"MessagesSquare","base_classes":["Message"],"display_name":"Chat Output","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"message","display_name":"Message","method":"message_response","value":"__UNDEFINED__","cache":true}],"field_order":["input_value","should_store_message","sender","sender_name","session_id","data_template","background_color","chat_icon","text_color"],"beta":false,"legacy":false,"edited":false,"metadata":{},"tool_mode":false,"lf_version":"1.1.0"},"id":"ChatOutput-gRH3m","description":"Display a chat message in the Playground.","display_name":"Chat Output"},"selected":false,"width":320,"height":234,"positionAbsolute":{"x":6431.647626448245,"y":1477.712405521416},"dragging":false},{"id":"TextOutput-NzWkN","type":"genericNode","position":{"x":5311.486599957447,"y":694.3173701277211},"data":{"type":"TextOutput","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.base.io.text import TextComponent\nfrom langflow.io import MultilineInput, Output\nfrom langflow.schema.message import Message\n\n\nclass TextOutputComponent(TextComponent):\n    display_name = \"Text Output\"\n    description = \"Display a text output in the Playground.\"\n    icon = \"type\"\n    name = \"TextOutput\"\n\n    inputs = [\n        MultilineInput(\n            name=\"input_value\",\n            display_name=\"Text\",\n            info=\"Text to be passed as output.\",\n        ),\n    ]\n    outputs = [\n        Output(display_name=\"Text\", name=\"text\", method=\"text_response\"),\n    ]\n\n    def text_response(self) -> Message:\n        message = Message(\n            text=self.input_value,\n        )\n        self.status = self.input_value\n        return message\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"input_value":{"trace_as_input":true,"multiline":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"input_value","value":"","display_name":"Text","advanced":false,"input_types":["Message"],"dynamic":false,"info":"Text to be passed as output.","title_case":false,"type":"str","_input_type":"MultilineInput"}},"description":"Display a text output in the Playground.","icon":"type","base_classes":["Message"],"display_name":"Final Prompt","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"text","display_name":"Text","method":"text_response","value":"__UNDEFINED__","cache":true}],"field_order":["input_value"],"beta":false,"edited":false,"lf_version":"1.1.0"},"id":"TextOutput-NzWkN"},"selected":false,"width":320,"height":234,"dragging":false,"positionAbsolute":{"x":5311.486599957447,"y":694.3173701277211}},{"id":"ResponseFilter-u5HS2","type":"genericNode","position":{"x":5917.2926420218655,"y":1473.055568266807},"data":{"type":"ResponseFilter","node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.custom import Component\nfrom langflow.io import MessageTextInput, Output\nfrom langflow.schema.message import Message\n\nclass SingleTurnFilterComponent(Component):\n    display_name = \"Response Filter\"\n    description = \"Removes multi-turn conversation markers (e.g., '\\\\nUser:', '\\\\nAI:') and ensures responses end with complete sentences.\"\n    icon = \"scissors-line-dashed\"\n    name = \"ResponseFilter\"\n\n    inputs = [\n        MessageTextInput(\n            name=\"text\",\n            display_name=\"Text\",\n            info=\"The input text containing conversation segments.\",\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Filtered Response\", name=\"filtered_response\", method=\"filter\"),\n    ]\n\n    def filter(self) -> Message:\n        # Access the input text directly\n        text = self.text\n\n        # Step 1: Remove multi-turn conversation markers, keeping only the initial response\n        filtered_response = text.split(\"\\nUser:\")[0].split(\"\\nAI:\")[0].strip()\n\n        # Step 2: Check for sentence-ending punctuation in the filtered response\n        sentence_endings = [\".\", \"!\", \"?\", \"…\", \"...\"]\n        if not any(filtered_response.endswith(p) for p in sentence_endings):\n            # If no sentence-ending punctuation, truncate to the last complete sentence\n            last_punctuation_index = max(filtered_response.rfind(p) for p in sentence_endings)\n            if last_punctuation_index != -1:\n                filtered_response = filtered_response[:last_punctuation_index + 1]\n        \n        # Set the component status and return the filtered response as a Message\n        self.status = filtered_response\n        return Message(text=filtered_response)\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"text":{"trace_as_input":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"text","value":"","display_name":"Text","advanced":false,"input_types":["Message"],"dynamic":false,"info":"The input text containing conversation segments.","title_case":false,"type":"str","_input_type":"MessageTextInput"}},"description":"Removes multi-turn conversation markers (e.g., '\\nUser:', '\\nAI:') and ensures responses end with complete sentences.","icon":"scissors-line-dashed","base_classes":["Message"],"display_name":"Response Filter","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"filtered_response","display_name":"Filtered Response","method":"filter","value":"__UNDEFINED__","cache":true}],"field_order":["text"],"beta":false,"edited":true,"lf_version":"1.1.0"},"id":"ResponseFilter-u5HS2"},"selected":false,"width":320,"height":274,"dragging":false,"positionAbsolute":{"x":5917.2926420218655,"y":1473.055568266807}},{"id":"TextOutput-PqVHE","type":"genericNode","position":{"x":2231.6893700933047,"y":-1134.9441677525647},"data":{"node":{"template":{"_type":"Component","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow.base.io.text import TextComponent\nfrom langflow.io import MultilineInput, Output\nfrom langflow.schema.message import Message\n\n\nclass TextOutputComponent(TextComponent):\n    display_name = \"Text Output\"\n    description = \"Display a text output in the Playground.\"\n    icon = \"type\"\n    name = \"TextOutput\"\n\n    inputs = [\n        MultilineInput(\n            name=\"input_value\",\n            display_name=\"Text\",\n            info=\"Text to be passed as output.\",\n        ),\n    ]\n    outputs = [\n        Output(display_name=\"Text\", name=\"text\", method=\"text_response\"),\n    ]\n\n    def text_response(self) -> Message:\n        message = Message(\n            text=self.input_value,\n        )\n        self.status = self.input_value\n        return message\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"input_value":{"tool_mode":false,"trace_as_input":true,"multiline":true,"trace_as_metadata":true,"load_from_db":false,"list":false,"required":false,"placeholder":"","show":true,"name":"input_value","value":"","display_name":"Text","advanced":false,"input_types":["Message"],"dynamic":false,"info":"Text to be passed as output.","title_case":false,"type":"str","_input_type":"MultilineInput"}},"description":"Display retriever selection with reasoning.","icon":"type","base_classes":["Message"],"display_name":"Retriever Selection","documentation":"","custom_fields":{},"output_types":[],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"text","display_name":"Text","method":"text_response","value":"__UNDEFINED__","cache":true}],"field_order":["input_value"],"beta":false,"legacy":false,"edited":false,"metadata":{},"tool_mode":false,"lf_version":"1.1.0"},"type":"TextOutput","id":"TextOutput-PqVHE"},"selected":false,"width":320,"height":234,"positionAbsolute":{"x":2231.6893700933047,"y":-1134.9441677525647},"dragging":false}],"edges":[{"source":"ChatInput-gqewG","sourceHandle":"{œdataTypeœ:œChatInputœ,œidœ:œChatInput-gqewGœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}","target":"Prompt-zHbUd","targetHandle":"{œfieldNameœ:œuser_messageœ,œidœ:œPrompt-zHbUdœ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"user_message","id":"Prompt-zHbUd","inputTypes":["Message","Text"],"type":"str"},"sourceHandle":{"dataType":"ChatInput","id":"ChatInput-gqewG","name":"message","output_types":["Message"]}},"id":"reactflow__edge-ChatInput-gqewG{œdataTypeœ:œChatInputœ,œidœ:œChatInput-gqewGœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}-Prompt-zHbUd{œfieldNameœ:œuser_messageœ,œidœ:œPrompt-zHbUdœ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","className":"","animated":false},{"source":"Prompt-zHbUd","sourceHandle":"{œdataTypeœ:œPromptœ,œidœ:œPrompt-zHbUdœ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}","target":"MyLLMModel-MNx8O","targetHandle":"{œfieldNameœ:œinput_valueœ,œidœ:œMyLLMModel-MNx8Oœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"input_value","id":"MyLLMModel-MNx8O","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"Prompt","id":"Prompt-zHbUd","name":"prompt","output_types":["Message"]}},"id":"reactflow__edge-Prompt-zHbUd{œdataTypeœ:œPromptœ,œidœ:œPrompt-zHbUdœ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}-MyLLMModel-MNx8O{œfieldNameœ:œinput_valueœ,œidœ:œMyLLMModel-MNx8Oœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","className":"","animated":false},{"source":"ChatInput-gqewG","sourceHandle":"{œdataTypeœ:œChatInputœ,œidœ:œChatInput-gqewGœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}","target":"NullRetriever-Snvzu","targetHandle":"{œfieldNameœ:œuser_inputœ,œidœ:œNullRetriever-Snvzuœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"user_input","id":"NullRetriever-Snvzu","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"ChatInput","id":"ChatInput-gqewG","name":"message","output_types":["Message"]}},"id":"reactflow__edge-ChatInput-gqewG{œdataTypeœ:œChatInputœ,œidœ:œChatInput-gqewGœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}-NullRetriever-Snvzu{œfieldNameœ:œuser_inputœ,œidœ:œNullRetriever-Snvzuœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"ChatInput-gqewG","sourceHandle":"{œdataTypeœ:œChatInputœ,œidœ:œChatInput-gqewGœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}","target":"FaissRetriever-WRZJ8","targetHandle":"{œfieldNameœ:œuser_inputœ,œidœ:œFaissRetriever-WRZJ8œ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"user_input","id":"FaissRetriever-WRZJ8","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"ChatInput","id":"ChatInput-gqewG","name":"message","output_types":["Message"]}},"id":"reactflow__edge-ChatInput-gqewG{œdataTypeœ:œChatInputœ,œidœ:œChatInput-gqewGœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}-FaissRetriever-WRZJ8{œfieldNameœ:œuser_inputœ,œidœ:œFaissRetriever-WRZJ8œ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"MyLLMModel-MNx8O","sourceHandle":"{œdataTypeœ:œMyLLMModelœ,œidœ:œMyLLMModel-MNx8Oœ,œnameœ:œtext_outputœ,œoutput_typesœ:[œMessageœ]}","target":"SelectionParser-JQ9Bk","targetHandle":"{œfieldNameœ:œselectionœ,œidœ:œSelectionParser-JQ9Bkœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"selection","id":"SelectionParser-JQ9Bk","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"MyLLMModel","id":"MyLLMModel-MNx8O","name":"text_output","output_types":["Message"]}},"id":"reactflow__edge-MyLLMModel-MNx8O{œdataTypeœ:œMyLLMModelœ,œidœ:œMyLLMModel-MNx8Oœ,œnameœ:œtext_outputœ,œoutput_typesœ:[œMessageœ]}-SelectionParser-JQ9Bk{œfieldNameœ:œselectionœ,œidœ:œSelectionParser-JQ9Bkœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"SelectionParser-JQ9Bk","sourceHandle":"{œdataTypeœ:œSelectionParserœ,œidœ:œSelectionParser-JQ9Bkœ,œnameœ:œparsedœ,œoutput_typesœ:[œMessageœ]}","target":"NullRetriever-Snvzu","targetHandle":"{œfieldNameœ:œselectionœ,œidœ:œNullRetriever-Snvzuœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"selection","id":"NullRetriever-Snvzu","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"SelectionParser","id":"SelectionParser-JQ9Bk","name":"parsed","output_types":["Message"]}},"id":"reactflow__edge-SelectionParser-JQ9Bk{œdataTypeœ:œSelectionParserœ,œidœ:œSelectionParser-JQ9Bkœ,œnameœ:œparsedœ,œoutput_typesœ:[œMessageœ]}-NullRetriever-Snvzu{œfieldNameœ:œselectionœ,œidœ:œNullRetriever-Snvzuœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"SelectionParser-JQ9Bk","sourceHandle":"{œdataTypeœ:œSelectionParserœ,œidœ:œSelectionParser-JQ9Bkœ,œnameœ:œparsedœ,œoutput_typesœ:[œMessageœ]}","target":"FaissRetriever-WRZJ8","targetHandle":"{œfieldNameœ:œselectionœ,œidœ:œFaissRetriever-WRZJ8œ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"selection","id":"FaissRetriever-WRZJ8","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"SelectionParser","id":"SelectionParser-JQ9Bk","name":"parsed","output_types":["Message"]}},"id":"reactflow__edge-SelectionParser-JQ9Bk{œdataTypeœ:œSelectionParserœ,œidœ:œSelectionParser-JQ9Bkœ,œnameœ:œparsedœ,œoutput_typesœ:[œMessageœ]}-FaissRetriever-WRZJ8{œfieldNameœ:œselectionœ,œidœ:œFaissRetriever-WRZJ8œ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"ChatInput-gqewG","sourceHandle":"{œdataTypeœ:œChatInputœ,œidœ:œChatInput-gqewGœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}","target":"NetworkXRetriever-rbGxV","targetHandle":"{œfieldNameœ:œuser_inputœ,œidœ:œNetworkXRetriever-rbGxVœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"user_input","id":"NetworkXRetriever-rbGxV","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"ChatInput","id":"ChatInput-gqewG","name":"message","output_types":["Message"]}},"id":"reactflow__edge-ChatInput-gqewG{œdataTypeœ:œChatInputœ,œidœ:œChatInput-gqewGœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}-NetworkXRetriever-rbGxV{œfieldNameœ:œuser_inputœ,œidœ:œNetworkXRetriever-rbGxVœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"SelectionParser-JQ9Bk","sourceHandle":"{œdataTypeœ:œSelectionParserœ,œidœ:œSelectionParser-JQ9Bkœ,œnameœ:œparsedœ,œoutput_typesœ:[œMessageœ]}","target":"NetworkXRetriever-rbGxV","targetHandle":"{œfieldNameœ:œselectionœ,œidœ:œNetworkXRetriever-rbGxVœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"selection","id":"NetworkXRetriever-rbGxV","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"SelectionParser","id":"SelectionParser-JQ9Bk","name":"parsed","output_types":["Message"]}},"id":"reactflow__edge-SelectionParser-JQ9Bk{œdataTypeœ:œSelectionParserœ,œidœ:œSelectionParser-JQ9Bkœ,œnameœ:œparsedœ,œoutput_typesœ:[œMessageœ]}-NetworkXRetriever-rbGxV{œfieldNameœ:œselectionœ,œidœ:œNetworkXRetriever-rbGxVœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"NullRetriever-Snvzu","sourceHandle":"{œdataTypeœ:œNullRetrieverœ,œidœ:œNullRetriever-Snvzuœ,œnameœ:œretrieved_contentsœ,œoutput_typesœ:[œMessageœ]}","target":"Prompt-860cs","targetHandle":"{œfieldNameœ:œfirstœ,œidœ:œPrompt-860csœ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"first","id":"Prompt-860cs","inputTypes":["Message","Text"],"type":"str"},"sourceHandle":{"dataType":"NullRetriever","id":"NullRetriever-Snvzu","name":"retrieved_contents","output_types":["Message"]}},"id":"reactflow__edge-NullRetriever-Snvzu{œdataTypeœ:œNullRetrieverœ,œidœ:œNullRetriever-Snvzuœ,œnameœ:œretrieved_contentsœ,œoutput_typesœ:[œMessageœ]}-Prompt-860cs{œfieldNameœ:œfirstœ,œidœ:œPrompt-860csœ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"FaissRetriever-WRZJ8","sourceHandle":"{œdataTypeœ:œFaissRetrieverœ,œidœ:œFaissRetriever-WRZJ8œ,œnameœ:œretrieved_textœ,œoutput_typesœ:[œMessageœ]}","target":"Prompt-860cs","targetHandle":"{œfieldNameœ:œsecondœ,œidœ:œPrompt-860csœ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"second","id":"Prompt-860cs","inputTypes":["Message","Text"],"type":"str"},"sourceHandle":{"dataType":"FaissRetriever","id":"FaissRetriever-WRZJ8","name":"retrieved_text","output_types":["Message"]}},"id":"reactflow__edge-FaissRetriever-WRZJ8{œdataTypeœ:œFaissRetrieverœ,œidœ:œFaissRetriever-WRZJ8œ,œnameœ:œretrieved_textœ,œoutput_typesœ:[œMessageœ]}-Prompt-860cs{œfieldNameœ:œsecondœ,œidœ:œPrompt-860csœ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"NetworkXRetriever-rbGxV","sourceHandle":"{œdataTypeœ:œNetworkXRetrieverœ,œidœ:œNetworkXRetriever-rbGxVœ,œnameœ:œretrieved_textœ,œoutput_typesœ:[œMessageœ]}","target":"Prompt-860cs","targetHandle":"{œfieldNameœ:œthirdœ,œidœ:œPrompt-860csœ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"third","id":"Prompt-860cs","inputTypes":["Message","Text"],"type":"str"},"sourceHandle":{"dataType":"NetworkXRetriever","id":"NetworkXRetriever-rbGxV","name":"retrieved_text","output_types":["Message"]}},"id":"reactflow__edge-NetworkXRetriever-rbGxV{œdataTypeœ:œNetworkXRetrieverœ,œidœ:œNetworkXRetriever-rbGxVœ,œnameœ:œretrieved_textœ,œoutput_typesœ:[œMessageœ]}-Prompt-860cs{œfieldNameœ:œthirdœ,œidœ:œPrompt-860csœ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","animated":false,"className":"","selected":false},{"source":"Prompt-860cs","sourceHandle":"{œdataTypeœ:œPromptœ,œidœ:œPrompt-860csœ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}","target":"TextOutput-Xryan","targetHandle":"{œfieldNameœ:œinput_valueœ,œidœ:œTextOutput-Xryanœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"input_value","id":"TextOutput-Xryan","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"Prompt","id":"Prompt-860cs","name":"prompt","output_types":["Message"]}},"id":"reactflow__edge-Prompt-860cs{œdataTypeœ:œPromptœ,œidœ:œPrompt-860csœ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}-TextOutput-Xryan{œfieldNameœ:œinput_valueœ,œidœ:œTextOutput-Xryanœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":"","selected":false},{"source":"Prompt-860cs","sourceHandle":"{œdataTypeœ:œPromptœ,œidœ:œPrompt-860csœ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}","target":"PoemPrompt-3ZbNY","targetHandle":"{œfieldNameœ:œpoemsœ,œidœ:œPoemPrompt-3ZbNYœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"poems","id":"PoemPrompt-3ZbNY","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"Prompt","id":"Prompt-860cs","name":"prompt","output_types":["Message"]}},"id":"reactflow__edge-Prompt-860cs{œdataTypeœ:œPromptœ,œidœ:œPrompt-860csœ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}-PoemPrompt-3ZbNY{œfieldNameœ:œpoemsœ,œidœ:œPoemPrompt-3ZbNYœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","className":"","animated":false},{"source":"Prompt-00f64","sourceHandle":"{œdataTypeœ:œPromptœ,œidœ:œPrompt-00f64œ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}","target":"MyLLMModel-iVF87","targetHandle":"{œfieldNameœ:œinput_valueœ,œidœ:œMyLLMModel-iVF87œ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"input_value","id":"MyLLMModel-iVF87","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"Prompt","id":"Prompt-00f64","name":"prompt","output_types":["Message"]}},"id":"reactflow__edge-Prompt-00f64{œdataTypeœ:œPromptœ,œidœ:œPrompt-00f64œ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}-MyLLMModel-iVF87{œfieldNameœ:œinput_valueœ,œidœ:œMyLLMModel-iVF87œ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","className":"","animated":false},{"source":"PoemPrompt-3ZbNY","sourceHandle":"{œdataTypeœ:œPoemPromptœ,œidœ:œPoemPrompt-3ZbNYœ,œnameœ:œparsedœ,œoutput_typesœ:[œMessageœ]}","target":"Prompt-00f64","targetHandle":"{œfieldNameœ:œinput_retrieved_poemsœ,œidœ:œPrompt-00f64œ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"input_retrieved_poems","id":"Prompt-00f64","inputTypes":["Message","Text"],"type":"str"},"sourceHandle":{"dataType":"PoemPrompt","id":"PoemPrompt-3ZbNY","name":"parsed","output_types":["Message"]}},"id":"reactflow__edge-PoemPrompt-3ZbNY{œdataTypeœ:œPoemPromptœ,œidœ:œPoemPrompt-3ZbNYœ,œnameœ:œparsedœ,œoutput_typesœ:[œMessageœ]}-Prompt-00f64{œfieldNameœ:œinput_retrieved_poemsœ,œidœ:œPrompt-00f64œ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"Memory-3CekQ","sourceHandle":"{œdataTypeœ:œMemoryœ,œidœ:œMemory-3CekQœ,œnameœ:œmessages_textœ,œoutput_typesœ:[œMessageœ]}","target":"Prompt-00f64","targetHandle":"{œfieldNameœ:œmemoryœ,œidœ:œPrompt-00f64œ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"memory","id":"Prompt-00f64","inputTypes":["Message","Text"],"type":"str"},"sourceHandle":{"dataType":"Memory","id":"Memory-3CekQ","name":"messages_text","output_types":["Message"]}},"id":"reactflow__edge-Memory-3CekQ{œdataTypeœ:œMemoryœ,œidœ:œMemory-3CekQœ,œnameœ:œmessages_textœ,œoutput_typesœ:[œMessageœ]}-Prompt-00f64{œfieldNameœ:œmemoryœ,œidœ:œPrompt-00f64œ,œinputTypesœ:[œMessageœ,œTextœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"Prompt-00f64","sourceHandle":"{œdataTypeœ:œPromptœ,œidœ:œPrompt-00f64œ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}","target":"TextOutput-NzWkN","targetHandle":"{œfieldNameœ:œinput_valueœ,œidœ:œTextOutput-NzWkNœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"input_value","id":"TextOutput-NzWkN","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"Prompt","id":"Prompt-00f64","name":"prompt","output_types":["Message"]}},"id":"reactflow__edge-Prompt-00f64{œdataTypeœ:œPromptœ,œidœ:œPrompt-00f64œ,œnameœ:œpromptœ,œoutput_typesœ:[œMessageœ]}-TextOutput-NzWkN{œfieldNameœ:œinput_valueœ,œidœ:œTextOutput-NzWkNœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"MyLLMModel-iVF87","sourceHandle":"{œdataTypeœ:œMyLLMModelœ,œidœ:œMyLLMModel-iVF87œ,œnameœ:œtext_outputœ,œoutput_typesœ:[œMessageœ]}","target":"ResponseFilter-u5HS2","targetHandle":"{œfieldNameœ:œtextœ,œidœ:œResponseFilter-u5HS2œ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"text","id":"ResponseFilter-u5HS2","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"MyLLMModel","id":"MyLLMModel-iVF87","name":"text_output","output_types":["Message"]}},"id":"reactflow__edge-MyLLMModel-iVF87{œdataTypeœ:œMyLLMModelœ,œidœ:œMyLLMModel-iVF87œ,œnameœ:œtext_outputœ,œoutput_typesœ:[œMessageœ]}-ResponseFilter-u5HS2{œfieldNameœ:œtextœ,œidœ:œResponseFilter-u5HS2œ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"MyLLMModel-MNx8O","sourceHandle":"{œdataTypeœ:œMyLLMModelœ,œidœ:œMyLLMModel-MNx8Oœ,œnameœ:œtext_outputœ,œoutput_typesœ:[œMessageœ]}","target":"TextOutput-PqVHE","targetHandle":"{œfieldNameœ:œinput_valueœ,œidœ:œTextOutput-PqVHEœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"input_value","id":"TextOutput-PqVHE","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"MyLLMModel","id":"MyLLMModel-MNx8O","name":"text_output","output_types":["Message"]}},"id":"reactflow__edge-MyLLMModel-MNx8O{œdataTypeœ:œMyLLMModelœ,œidœ:œMyLLMModel-MNx8Oœ,œnameœ:œtext_outputœ,œoutput_typesœ:[œMessageœ]}-TextOutput-PqVHE{œfieldNameœ:œinput_valueœ,œidœ:œTextOutput-PqVHEœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""},{"source":"ResponseFilter-u5HS2","sourceHandle":"{œdataTypeœ:œResponseFilterœ,œidœ:œResponseFilter-u5HS2œ,œnameœ:œfiltered_responseœ,œoutput_typesœ:[œMessageœ]}","target":"ChatOutput-gRH3m","targetHandle":"{œfieldNameœ:œinput_valueœ,œidœ:œChatOutput-gRH3mœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","data":{"targetHandle":{"fieldName":"input_value","id":"ChatOutput-gRH3m","inputTypes":["Message"],"type":"str"},"sourceHandle":{"dataType":"ResponseFilter","id":"ResponseFilter-u5HS2","name":"filtered_response","output_types":["Message"]}},"id":"reactflow__edge-ResponseFilter-u5HS2{œdataTypeœ:œResponseFilterœ,œidœ:œResponseFilter-u5HS2œ,œnameœ:œfiltered_responseœ,œoutput_typesœ:[œMessageœ]}-ChatOutput-gRH3m{œfieldNameœ:œinput_valueœ,œidœ:œChatOutput-gRH3mœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}","animated":false,"className":""}],"viewport":{"x":-199.0397713033518,"y":-466.5634801668141,"zoom":1.1760508605079145}},"description":"","name":"PoetryMemoryChatbot","last_tested_version":"1.1.0","endpoint_name":null,"is_component":false}